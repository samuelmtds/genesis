<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Validating data - genesis</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Allan Jones Batista de Castro"></meta><meta name="email" content="allanjones@dev.java.net"></meta><meta name="author" content="Michael Nascimento Santos"></meta><meta name="email" content="mister__m@dev.java.net"></meta></head><body class="composite"><div id="banner"><a href="https://genesis.dev.java.net/" id="projectLogo"><img alt="SOL Genesis" src="../genesis.gif"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 13 December 2006
                <span class="separator">|</span> Doc for  3.0-EA5
                </div><div class="xright">
        
        <a href="../index.html">genesis</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-aspect/index.html">genesis-aspect</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-client/index.html">genesis-client</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-server/index.html">genesis-server</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-shared/index.html">genesis-shared</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../tags/genesis-tags.html">genesis-xdoclet</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menugenesis"><h5>genesis</h5><ul><li class="none"><a href="../en/index.html">Overview</a></li><li class="none"><a href="../en/download.html">Downloads</a></li><li class="none"><a href="../en/release_notes.html">Release notes</a></li></ul></div><div id="menuDocumentation"><h5>Documentation</h5><ul><li class="expanded"><a href="../en/documentation_intro.html">User manual</a><ul><li class="none"><a href="../en/documentation_intro.html">Introduction</a></li><li class="none"><a href="../en/annotations.html">Using annotations</a></li><li class="none"><a href="../en/startup.html">Configuring genesis at startup</a></li><li class="expanded"><a href="../en/remoting.html">Basic features</a><ul><li class="none"><a href="../en/remoting.html">Transparent remoting</a></li><li class="none"><a href="../en/transactions.html">Transaction support</a></li><li class="none"><a href="../en/hibernate_integration.html">Hibernate integration</a></li><li class="none"><a href="../en/binding.html">Binding</a></li><li class="none"><a href="../en/actions.html">Implementing mixed actions</a></li></ul></li><li class="expanded"><a href="../en/thinlet_binding.html">Thinlet-specific features</a><ul><li class="none"><a href="../en/thinlet_binding.html">Thinlet Binding</a></li><li class="none"><a href="../en/customizing_widgets_creation.html">Customizing widget creation</a></li></ul></li><li class="expanded"><a href="../en/configuring_swt.html">SWT-specific features</a><ul><li class="none"><a href="../en/configuring_swt.html">Configuring SWT libraries</a></li></ul></li><li class="expanded"><a href="../en/conditions.html">Additional features</a><ul><li class="none"><a href="../en/conditions.html">Working with conditions</a></li><li class="none"><a href="../en/populating_with_dataproviders.html">Populating comboboxes, lists and tables</a></li><li class="none"><a href="../en/formatting.html">Formatting data</a></li><li class="none"><a href="../en/handling_errors.html">Handling errors</a></li><li class="none"><strong><a href="../en/validating_data.html">Validating data</a></strong></li><li class="none"><a href="../en/configuring_messages.html">Configuring messages</a></li><li class="none"><a href="../en/paging_and_dynamic_search.html">Paging and dynamic queries</a></li></ul></li><li class="none"><a href="../en/quick_reference.html">Annotation quick reference guide</a></li></ul></li><li class="expanded"><a href="../en/empty_project.html">Developing with genesis</a><ul><li class="none"><a href="../en/empty_project.html">For desktops</a></li><li class="none"><a href="../en/empty_web_project.html">For web</a></li></ul></li><li class="none"><a href="../en/useradmin_sample.html">Using the UserAdmin sample</a></li><li class="expanded"><a href="../en/advanced_introduction.html">Advanced guide</a><ul><li class="none"><a href="../en/xdoclet_extensions.html">XDoclet extensions</a></li><li class="none"><a href="../en/aspects.html">genesis aspects</a></li><li class="none"><a href="../en/generic_scripting.html">Generic scripting support</a></li><li class="none"><a href="../en/lookup_strategy.html">Widget lookup strategies</a></li><li class="none"><a href="../en/widget_binder.html">Customizing widget binding</a></li></ul></li><li class="none"><a href="../en/faq.html">FAQ</a></li><li class="none"><a href="http://wiki.java.net/bin/view/Projects/GenesisRoadmap" class="externalLink" title="External Link">Roadmap</a></li><li class="none"><a href="http://wiki.java.net/bin/view/Projects/Genesis" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="http://maven.apache.org/development-process.html" class="externalLink" title="External Link">Development Process</a></li></ul></div><div id="menujava_net"><h5>java.net</h5><ul><li class="none"><a href="https://genesis.dev.java.net" class="externalLink" title="External Link">genesis.dev.java.net</a></li><li class="none"><a href="http://java.net" class="externalLink" title="External Link"><img title="java.net member" style="border: 1px" src="../java_dot_net_member.bmp" alt="java.net member"></img></a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/maven-button-1.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Validating_data"></a><h2>Validating data</h2>
      <p>Data validation is critical for system integrity, especially when data
      is entered by users, as is the case for UI applications. Support for
      validation in genesis is implemented by using one of Jakarta project's
      components, <a href="http://jakarta.apache.org/commons/validator/" class="externalLink" title="External Link">commons-validator</a>.
      Several other open-source frameworks use commons-validator as a foundation
      for their own validation components, including Struts, so it is likely you 
      are already used to this API. Otherwise, we recommend reading the docs 
      from their project site.</p>
      <p>Annotation <code>@ValidateBefore</code> can be used in actions that are
      only supposed to be executed when validation succeeds. If a validation 
      error occurs, a <code>net.java.dev.genesis.ui.ValidationException</code> 
      will be thrown - an exception that is <a href="handling_errors.html">handled by default</a> by genesis by 
      displaying error information in an user-friendly way.</p>
      <p>Several default validators are implemented by 
      <code>BasicValidator</code>, which is contained in the
      <code>net.java.dev.genesis.ui</code> package. Most of these validators are
      similar to the ones provided with Struts, so it is easier for those 
      familiar with this framework to understand them. They are:</p>
      <ul>
        <li><code><b>byte</b>, <b>short</b>, <b>int</b>, <b>long</b>,
        <b>float</b> and <b>double</b></code>: check if data can be converted to
        one of these types without any overflow.</li>
        <li><code><b>bigDecimal</b></code>: checks if data can be converted to
        <code>java.math.BigDecimal</code> using the default <a href="http://jakarta.apache.org/commons/beanutils/" class="externalLink" title="External Link">BeanUtils</a> converter
        registered for this class. genesis provides a custom implementation of 
        this converter, <code>BigDecimalConverter</code> in
        <code>net.java.dev.genesis.commons.beanutils.converters</code>, since
        implementations that ship with BeanUtils do not work as expected for the
        pt-BR Locale.</li>
        <li><code><b>date</b></code>: implements date validation. The
        variable <code>pattern</code> can be used to set a valid data pattern to
        be used for the process. This pattern should follow the 
        <code>java.text.DateFormat</code> pattern specification.</li>
        <li><code><b>email</b></code>: only accepts content that can be
        considered a syntatically valid email.</li>
        <li><code><b>required</b></code>: asserts the field is not empty.</li>
        <li><code><b>requiredif</b></code>: compatible with the version that
        comes with Struts, it implements a somewhat weak validation scheme. Its 
        use is not recommended and it is provided just as a way to make it 
        easier for Struts users to use genesis validation. Use the <a href="#jxpath">jxpath</a> validator instead.</li>
        <li><code><b>mask</b></code>: implements validation based on a regular
        expression. It requires the definition of a <code>mask</code>
        variable containg the regular expression.</li>
        <li><code><b>minlength</b> and <b>maxlength</b></code>: guarantee that
        informed data has at least and at most, respectively, the number of 
        characters defined by the <code>minlength</code> or 
        <code>maxlength</code> variables.</li>
        <li><code><b>min</b></code>: checks if the number is greater or equal to 
        the value defined by the <code>min</code> variable.</li>
        <li><code><b>max</b></code>: checks if the number is lesser or equal to 
        the value defined by the <code>max</code> variable.</li>
        <li><code><b>longRange</b>, <b>doubleRange</b> and <b>bigDecimalRange</b></code>: check if the number is part of an expected interval, defined 
        by variables <code>min</code> and <code>max</code>.</li>
        <li><a name="script"><code><b>script</b></code></a>: it considers data 
        as valid if evaluating the script expression 
        defined by the variable named <code>script</code> returns a value 
        different from <code>java.lang.Boolean.FALSE</code>.</li>
      </ul>
      <p>As it is true for Struts validators, all the validators provided with 
      genesis except for <code>script</code> are only triggered if the field is 
      not empty. This means that <b>even if you configure a validator properly, 
      it will be invoked only when the user inputs something into the field</b>. 
      If you would like your validator to always be run, <code>required</code> 
      should also be configured for the field.</p>
      <p>Validators receive the input in its "raw" String form. It's
      important to keep that in mind when coding script expressions or using a
      custom validator.</p>
      <p>The class that integrates commons-validator with genesis,
      <code>net.java.dev.genesis.ui.ValidationUtils</code>, expects two
      configuration files to be available in the classpath:
      <code>validation-rules.xml</code> and <code>validation.xml</code>. These
      files must be comply with the commons-validator 1.1 DTD. A default
      configuration for <code>validation-rules.xml</code> is provided with
      genesis-client jar as shown below:</p>

    <div class="source"><pre>

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE form-validation PUBLIC 
   '-//Apache Software Foundation//DTD Commons Validator Rules Configuration 1.1//EN' 
   'http://jakarta.apache.org/commons/dtds/validator_1_1.dtd'&gt;
&lt;form-validation&gt;
    &lt;global&gt;
        &lt;validator name="byte" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateByte" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.byte"/&gt;
        &lt;validator name="short" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateShort" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.short"/&gt;	
        &lt;validator name="int" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateInt" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.int"/&gt;
        &lt;validator name="long" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateLong" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.long"/&gt;
        &lt;validator name="float" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateFloat" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.float"/&gt;
        &lt;validator name="double" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateDouble" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.double"/&gt;
        &lt;validator name="bigDecimal" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateBigDecimal" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.bigdecimal"/&gt;
        &lt;validator name="required" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateRequired" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.required"/&gt;
        &lt;validator name="requiredif" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateRequiredIf" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field,org.apache.commons.validator.Validator" 
                msg="errors.requiredif"/&gt;
        &lt;validator name="mask" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateMask" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.mask"/&gt;
        &lt;validator name="email" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateEmail" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.email"/&gt;
        &lt;validator name="date" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateDate" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.date"/&gt;			
        &lt;validator name="minlength" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateMinLength" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.minlength"/&gt;			
        &lt;validator name="maxlength" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateMaxLength" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.maxlength"/&gt;			
        &lt;validator name="min" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateMin" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.min"/&gt;	
        &lt;validator name="max" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateMax" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.max"/&gt;	
        &lt;validator name="longRange" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateLongRange" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.longRange"/&gt;			
        &lt;validator name="doubleRange" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateDoubleRange" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.doubleRange"/&gt;		
        &lt;validator name="bigDecimalRange" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateBigDecimalRange" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.bigDecimalRange"/&gt;
        &lt;!-- jxpath validator is deprecated. Use script validator instead --&gt;
        &lt;validator name="jxpath" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateJXPath" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.jxpath"/&gt;
        &lt;validator name="script" 
                classname="net.java.dev.genesis.ui.BasicValidator" 
                method="validateScript" 
                methodParams="java.lang.Object,org.apache.commons.validator.Field" 
                msg="errors.script"/&gt;
    &lt;/global&gt;
&lt;/form-validation&gt;

</pre></div>
  
      <p>Usually, the most practical way to configure form validation is to use
      <a href="http://xdoclet.sourceforge.net/" class="externalLink" title="External Link">XDoclet</a>. An example of how to 
      configure validation for a form from the useradmin sample is the 
      <code>InsertUpdateForm</code> class, from package 
      <code>net.java.dev.genesis.samples.useradmin.ui</code>, partially shown 
      below:</p>

    <div class="source"><pre>
/**
 * @genesis.form
 */
@Form
public class InsertUpdateForm {
   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.birthday"
    *
    * @genesis.validator type="date"
    * @genesis.validator-var name="pattern" value="MM/dd/yyyy"
    */
   public void setBirthday(Date birthday) {
      this.birthday = birthday;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.country"
    */
   public void setCountry(Country country) {
      this.country = country;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.email"
    *
    * @genesis.validator type="email"
    * @genesis.validator-args arg0resource="User.email"
    */
   public void setEmail(String email) {
      this.email = email;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.role"
    */
   public void setRole(Role role) {
      this.role = role;
      setRoleCode(role == null ? null : role.getCode());
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.login"
    *
    * @genesis.validator type="minlength" arg1value="${var:minlength}"
    * @genesis.validator-var name="minlength" value="4"
    */
   public void setLogin(String login) {
      this.login = login;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.name"
    */
   public void setName(String name) {
      this.name = name;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.password"
    *
    * @genesis.validator type="minlength" arg1value="${var:minlength}"
    * @genesis.validator-var name="minlength" value="6"
    *
    * @genesis.validator type="maxlength" arg1value="${var:maxlength}"
    * @genesis.validator-var name="maxlength" value="8"
    */
   public void setPassword(String password) {
      this.password = password;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.address"
    */
   public void setAddress(String address) {
      this.address = address;
   }

   /**
    * @genesis.validator type="required"
    * @genesis.validator-args arg0resource="User.state"
    */
   public void setState(State state) {
      this.state = state;
   }

   @Action
   @ValidateBefore
   public void save() throws Exception {
      final User user = new User();
      PropertyUtils.copyProperties(user, this);
      if (getId() == null) {
         new UserCreateCommand().createUser(user);
      } else {
         new UserUpdateCommand().updateUser(user);
      }
   }

   // ...
}
</pre></div>
  
      <p>Before invoking <code>save()</code>, validation is executed based on
      the rules defined by the generated file and eventual errors will prevent
      the method from being executed. For those not used to XDoclet, here is a 
      transcription from the <code>validation.xml</code> file generated during 
      build execution:</p>

    <div class="source"><pre>

&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;
&lt;!DOCTYPE form-validation PUBLIC
   '-//Apache Software Foundation//DTD Commons Validator Rules Configuration
   1.1//EN'
   'http://jakarta.apache.org/commons/dtds/validator_1_1.dtd'&gt;
&lt;form-validation&gt;
  &lt;!--
    Define global validation config in validation-global.xml
  --&gt;
  &lt;formset&gt;
      &lt;form name="net.java.dev.genesis.samples.useradmin.ui.InsertUpdateForm"&gt;
              &lt;field property="birthday"
                     depends="required,date"&gt;
                  &lt;arg position="0"
                       key="User.birthday"
                  /&gt;
                  &lt;var&gt;
                    &lt;var-name&gt;pattern&lt;/var-name&gt;
                    &lt;var-value&gt;MM/dd/yyyy&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
              &lt;field property="country"
                     depends="required"&gt;
                  &lt;arg position="0"
                       key="User.country"
                  /&gt;
              &lt;/field&gt;
              &lt;field property="email"
                     depends="required,email"&gt;
                  &lt;arg position="0"
                       key="User.email"
                  /&gt;
              &lt;/field&gt;
              &lt;field property="role"
                     depends="required"&gt;
                  &lt;arg position="0"
                       key="User.role"
                  /&gt;
              &lt;/field&gt;
              &lt;field property="login"
                     depends="required,minlength"&gt;
                  &lt;arg position="0"
                       key="User.login"
                  /&gt;
                  &lt;arg position="1"
                       name="minlength"
                       key="${var:minlength}"
                       resource="false"
                  /&gt;
                  &lt;var&gt;
                    &lt;var-name&gt;minlength&lt;/var-name&gt;
                    &lt;var-value&gt;4&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
              &lt;field property="name"
                     depends="required"&gt;
                  &lt;arg position="0"
                       key="User.name"
                  /&gt;
              &lt;/field&gt;
              &lt;field property="password"
                     depends="required,minlength,maxlength"&gt;
                  &lt;arg position="0"
                       key="User.password"
                  /&gt;
                  &lt;arg position="1"
                       name="minlength"
                       key="${var:minlength}"
                       resource="false"
                  /&gt;
                  &lt;arg position="1"
                       name="maxlength"
                       key="${var:maxlength}"
                       resource="false"
                  /&gt;
                  &lt;var&gt;
                    &lt;var-name&gt;minlength&lt;/var-name&gt;
                    &lt;var-value&gt;6&lt;/var-value&gt;
                  &lt;/var&gt;
                  &lt;var&gt;
                    &lt;var-name&gt;maxlength&lt;/var-name&gt;
                    &lt;var-value&gt;8&lt;/var-value&gt;
                  &lt;/var&gt;
              &lt;/field&gt;
              &lt;field property="address"
                     depends="required"&gt;
                  &lt;arg position="0"
                       key="User.address"
                  /&gt;
              &lt;/field&gt;
              &lt;field property="state"
                     depends="required"&gt;
                  &lt;arg position="0"
                       key="User.state"
                  /&gt;
              &lt;/field&gt;
      &lt;/form&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;

</pre></div>
  
      <p>A resource file is used to configure messages, as described in <a href="configuring_messages.html">Configuring messages</a>.
      </p>
    </div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2004-2006, Summa Tecnologies do Brasil Ltda.</div><div class="clear"><hr></hr></div></div></body></html>