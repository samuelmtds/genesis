<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Transparent remoting - genesis</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Allan Jones Batista de Castro"></meta><meta name="email" content="allanjones@dev.java.net"></meta><meta name="author" content="Michael Nascimento Santos"></meta><meta name="email" content="mister__m@dev.java.net"></meta></head><body class="composite"><div id="banner"><a href="https://genesis.dev.java.net/" id="projectLogo"><img alt="SOL Genesis" src="../genesis.gif"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 27 May 2008
                <span class="separator">|</span> Doc for  3.1
                </div><div class="xright">
        
        <a href="../index.html">genesis</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-aspect/index.html">genesis-aspect</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-client/index.html">genesis-client</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-server/index.html">genesis-server</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-shared/index.html">genesis-shared</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../tags/genesis-tags.html">genesis-xdoclet</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menugenesis"><h5>genesis</h5><ul><li class="none"><a href="../en/index.html">Overview</a></li><li class="none"><a href="../en/download.html">Downloads</a></li><li class="none"><a href="../en/release_notes.html">Release notes</a></li></ul></div><div id="menuDocumentation"><h5>Documentation</h5><ul><li class="expanded"><a href="../en/documentation_intro.html">User manual</a><ul><li class="none"><a href="../en/documentation_intro.html">Introduction</a></li><li class="none"><a href="../en/annotations.html">Using annotations</a></li><li class="none"><a href="../en/startup.html">Configuring genesis at startup</a></li><li class="expanded"><strong><a href="../en/remoting.html">Basic features</a></strong><ul><li class="none"><strong><a href="../en/remoting.html">Transparent remoting</a></strong></li><li class="none"><a href="../en/transactions.html">Transaction support</a></li><li class="none"><a href="../en/hibernate_integration.html">Hibernate integration</a></li><li class="none"><a href="../en/binding.html">Binding</a></li><li class="none"><a href="../en/actions.html">Implementing mixed actions</a></li></ul></li><li class="expanded"><a href="../en/thinlet_binding.html">Thinlet-specific features</a><ul><li class="none"><a href="../en/thinlet_binding.html">Thinlet Binding</a></li><li class="none"><a href="../en/customizing_widgets_creation.html">Customizing widget creation</a></li></ul></li><li class="expanded"><a href="../en/configuring_swt.html">SWT-specific features</a><ul><li class="none"><a href="../en/configuring_swt.html">Configuring SWT libraries</a></li></ul></li><li class="expanded"><a href="../en/conditions.html">Additional features</a><ul><li class="none"><a href="../en/conditions.html">Working with conditions</a></li><li class="none"><a href="../en/populating_with_dataproviders.html">Populating comboboxes, lists and tables</a></li><li class="none"><a href="../en/binding_toggle_buttons.html">Binding radiobuttons and checkboxes</a></li><li class="none"><a href="../en/binding_strategy.html">Configuring binding strategies</a></li><li class="none"><a href="../en/formatting.html">Formatting data</a></li><li class="none"><a href="../en/handling_errors.html">Handling errors</a></li><li class="none"><a href="../en/validating_data.html">Validating data</a></li><li class="none"><a href="../en/configuring_messages.html">Configuring messages</a></li><li class="none"><a href="../en/paging_and_dynamic_search.html">Paging and dynamic queries</a></li></ul></li><li class="none"><a href="../en/quick_reference.html">Annotation quick reference guide</a></li></ul></li><li class="expanded"><a href="../en/empty_project.html">Developing with genesis</a><ul><li class="none"><a href="../en/empty_project.html">For desktops</a></li><li class="none"><a href="../en/empty_web_project.html">For web</a></li></ul></li><li class="none"><a href="../en/useradmin_sample.html">Using the UserAdmin sample</a></li><li class="expanded"><a href="../en/advanced_introduction.html">Advanced guide</a><ul><li class="none"><a href="../en/xdoclet_extensions.html">XDoclet extensions</a></li><li class="none"><a href="../en/aspects.html">genesis aspects</a></li><li class="none"><a href="../en/generic_scripting.html">Generic scripting support</a></li><li class="none"><a href="../en/lookup_strategy.html">Widget lookup strategies</a></li><li class="none"><a href="../en/widget_binder.html">Customizing widget binding</a></li></ul></li><li class="none"><a href="../en/faq.html">FAQ</a></li><li class="none"><a href="http://wiki.java.net/bin/view/Projects/GenesisRoadmap" class="externalLink" title="External Link">Roadmap</a></li><li class="none"><a href="http://wiki.java.net/bin/view/Projects/Genesis" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="http://maven.apache.org/development-process.html" class="externalLink" title="External Link">Development Process</a></li></ul></div><div id="menujava_net"><h5>java.net</h5><ul><li class="none"><a href="https://genesis.dev.java.net" class="externalLink" title="External Link">genesis.dev.java.net</a></li><li class="none"><a href="http://java.net" class="externalLink" title="External Link"><img title="java.net member" style="border: 1px" src="../java_dot_net_member.bmp" alt="java.net member"></img></a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/maven-button-1.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Transparent_remoting"></a><h2>Transparent remoting</h2>
      <p>Suppose there is a class called <code>SumExample</code> as below:</p>

    <div class="source"><pre>
 1. public class SumExample {
 2.    public int sum(int a, int b) {
 3.       System.out.println("a = " + a);
 4.       System.out.println("b = " + b);
 5.
 6.       int sum = a + b;
 7.
 8.       System.out.println("a + b = " + sum);
 9.
10.       return sum;
11.    }
12.
13.    public static void main(String[] args) {
14.       System.out.println(new SumExample().sum(2, 2));
15.    }
16. }
</pre></div>
  
      <p>By running the code, the following output will be printed at the local
      standard output:</p>

    <div class="source"><pre>
a = 2
b = 2
a + b = 4
4
</pre></div>
  
      <p>The <code>sum(int, int)</code> method can be turned to a remote one by
      simply adding a <code>@Remotable</code> annotation. The modified code
      would be:</p>

    <div class="source"><pre>
 1. import net.java.dev.genesis.annotation.Remotable;
 2.
 3. public class RemoteSumExample {
 4.    @Remotable
 5.    public int sum(int a, int b) {
 6.       System.out.println("a = " + a);
 7.       System.out.println("b = " + b);
 8.
 9.       int soma = a + b;
10.
11.       System.out.println("a + b = " + sum);
12.
13.       return sum;
14.    }
15.
16.    public static void main(String[] args) {
17.       System.out.println(new RemoteSumExample().sum(2, 2));
18.    }
19. }
</pre></div>
  
      <p>By running the new code after starting JBoss, we notice a decrease in 
      the output lines:</p>

    <div class="source"><pre>
4
</pre></div>
  
      <p>By watching the JBoss console, it is possible to notice that some 
      messages were printed at the server-side. Why that happened?</p>
      <p>The output seen at the local console is due to the execution of 17th
      line. However, other <code>System.out.println</code> calls from the 6th,
      7th and 11th lines took place inside an annotated method with
      <code>@Remotable</code> and that's why they were executed in a different
      way. Actually the whole <code>sum(int,int)</code> method was executed
      at the server-side. How?</p>
      <p>Methods annotated with <code>@Remotable</code> are intercepted by an 
      aspect (genesis-aspect) that will transport the instance in which the 
      method was called to the server-side, and then this method will be 
      executed there. The result will be sent back to the client-side. This 
      feature is called <b>transparent remoting</b>.</p>
      <div class="subsection"><a name="Restrictions_and_limitations"></a><h3>Restrictions and limitations</h3>
        <p>There are some restrictions on which methods that can be made remote
        in genesis:
          <ul>
            <li>It cannot be abstract</li>
            <li>It cannot be a static method nor manipulate static members</li>
            <li>It cannot be native</li>
            <li>It must be <code>public</code> and declared in a
            <code>public</code> class</li>
          </ul>
        </p>
        <p>The first restriction exists because an abstract method cannot be
        called (however it might be declared as abstract in a superclass). The 
        method cannot be static because static values differ between different 
        JVMs. The last two restrictions are imposed to comply with the EJB 
        specification.</p>
        <p>One last side effect to be aware of is that remote methods do not 
        change the value of local instances variables. We can see an example 
        below:</p>

    <div class="source"><pre>
 1. import net.java.dev.genesis.annotation.Remotable;
 2.
 3. public class LocalVersusRemote {
 4.    private int value;
 5.
 6.    public void local() {
 7.       value++;
 8.       System.out.println("value in local(): " + value);
 9.    }
10.
11.    @Remotable
12.    public void remote() {
13.       value++;
14.       System.out.println("value in remote(): " + value);
15.    }
16.
17.    public int getValue() {
18.       return value;
19.    }
20.
21.    public static void main(String[] args) {
22.       LocalVersusRemote lvr = new LocalVersusRemote();
23.       lvr.local();
24.       System.out.println("value: " + lvr.getValue());
25.       lvr.remote();
26.       System.out.println("value: " + lvr.getValue());
27.       lvr.local();
28.       System.out.println("value: " + lvr.getValue());
29.    }
30. }
</pre></div>
  
        <p>The local output will be:</p>

    <div class="source"><pre>
value in local(): 1
value: 1
value: 1
value in local(): 2
value: 2
</pre></div>
  
        <p>While the remote output will be:</p>

    <div class="source"><pre>
value in remote(): 2
</pre></div>
  
        <p>When the 23rd line is reached, the <code>value</code> variable is 
        locally modified and its content in both the <code>local()</code> method 
        and the 24th line output the same. However, by running the 25th line, the
        <code>lvr</code> instance is sent to the server and the
        <code>remote()</code> method is executed there, modifying the remote
        copy of <code>value</code> from 1 to 2, as shown at the remote console
         - but the local copy is kept unmodified as we can see with the 26th
        line output (local console).</p>
        <p>Therefore, local values are sent to the server but not the other way
        around. The same restriction applies to object references in parameters.
        If it is necessary to get a reference to the modified instance, it must 
        be returned from the annotated method itself.</p>
        <p>To fix the problem above, we can change it to return the modified
        value:</p>

    <div class="source"><pre>
    @Remotable
    public int remote() {
       valor++;
       System.out.println("value in remote(): " + value);
       return value;
    }

    public void setValue(int value) {
       this.value = value;

    }

    public static void main(String[] args) {
       LocalVersusRemote lvr = new LocalVersusRemote();
       // ...
       lvr.setValue(lvr.remote());
       // ...
    }
</pre></div>
  
        <p>This might intimidate some developers at first, but this is exactly
        how a Stateless Session Bean (SSB) works, for example. And the behavior
        of non-remote parameters sent through a RMI call is also the same. A
        stateful component model will be implemented in the near future, 
        although experience has shown us that it's not necessary for desktop and 
        web clients, and that the problem can be handled the same way you deal 
        with it when using SSBs or RMI components: returning the modified data 
        in the method call.</p>
      </div>
    </div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2004-2008, Summa Technologies do Brasil Ltda.</div><div class="clear"><hr></hr></div></div></body></html>