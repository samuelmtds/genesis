<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Binding - genesis</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Michael Nascimento Santos"></meta><meta name="email" content="mister__m@dev.java.net"></meta></head><body class="composite"><div id="banner"><a href="https://genesis.dev.java.net/" id="projectLogo"><img alt="SOL Genesis" src="../genesis.gif"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 08 June 2007
                <span class="separator">|</span> Doc for  3.0
                </div><div class="xright">
        
        <a href="../index.html">genesis</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-aspect/index.html">genesis-aspect</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-client/index.html">genesis-client</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-server/index.html">genesis-server</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../multiproject/genesis-shared/index.html">genesis-shared</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="../tags/genesis-tags.html">genesis-xdoclet</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menugenesis"><h5>genesis</h5><ul><li class="none"><a href="../pt-BR/index.html">Visão geral</a></li><li class="none"><a href="../pt-BR/download.html">Downloads</a></li><li class="none"><a href="../pt-BR/release_notes.html">Notas de versão</a></li></ul></div><div id="menuDocumentação"><h5>Documentação</h5><ul><li class="expanded"><a href="../pt-BR/documentation_intro.html">Manual do usuário</a><ul><li class="none"><a href="../pt-BR/documentation_intro.html">Introdução</a></li><li class="none"><a href="../pt-BR/annotations.html">Usando anotações</a></li><li class="none"><a href="../pt-BR/startup.html">Inicializando o genesis</a></li><li class="expanded"><a href="../pt-BR/remoting.html">Funcionalidades básicas</a><ul><li class="none"><a href="../pt-BR/remoting.html">Remotabilidade transparente</a></li><li class="none"><a href="../pt-BR/transactions.html">Suporte a transações</a></li><li class="none"><a href="../pt-BR/hibernate_integration.html">Integração com o Hibernate</a></li><li class="none"><strong><a href="../pt-BR/binding.html">Binding</a></strong></li><li class="none"><a href="../pt-BR/actions.html">Implementando ações mistas</a></li></ul></li><li class="expanded"><a href="../pt-BR/thinlet_binding.html">Funcionalidades específicas para Thinlet</a><ul><li class="none"><a href="../pt-BR/thinlet_binding.html">Binding Thinlet</a></li><li class="none"><a href="../pt-BR/customizing_widgets_creation.html">Customizando a criação de componentes</a></li></ul></li><li class="expanded"><a href="../pt-BR/configuring_swt.html">Funcionalidades específicas para SWT</a><ul><li class="none"><a href="../pt-BR/configuring_swt.html">Configurando as bibliotecas do SWT</a></li></ul></li><li class="expanded"><a href="../pt-BR/conditions.html">Funcionalidades adicionais</a><ul><li class="none"><a href="../pt-BR/conditions.html">Trabalhando com condições</a></li><li class="none"><a href="../pt-BR/populating_with_dataproviders.html">Populando combos, listas e tabelas</a></li><li class="none"><a href="../pt-BR/binding_toggle_buttons.html">Binding de botões de rádio e caixas de seleção</a></li><li class="none"><a href="../pt-BR/binding_strategy.html">Mudando a estratégia de binding</a></li><li class="none"><a href="../pt-BR/formatting.html">Formatando os dados</a></li><li class="none"><a href="../pt-BR/handling_errors.html">Tratando erros</a></li><li class="none"><a href="../pt-BR/validating_data.html">Validando os dados</a></li><li class="none"><a href="../pt-BR/configuring_messages.html">Configurando as mensagens</a></li><li class="none"><a href="../pt-BR/paging_and_dynamic_search.html">Paginação e pesquisas dinâmicas</a></li></ul></li><li class="none"><a href="../pt-BR/quick_reference.html">Guia de referência rápida de anotações</a></li></ul></li><li class="expanded"><a href="../pt-BR/empty_project.html">Desenvolvendo com o genesis</a><ul><li class="none"><a href="../pt-BR/empty_project.html">Para desktops</a></li><li class="none"><a href="../pt-BR/empty_web_project.html">Para web</a></li></ul></li><li class="none"><a href="../pt-BR/useradmin_sample.html">Usando o exemplo UserAdmin</a></li><li class="expanded"><a href="../pt-BR/advanced_introduction.html">Guia avançado</a><ul><li class="none"><a href="../pt-BR/xdoclet_extensions.html">Extensões do XDoclet</a></li><li class="none"><a href="../pt-BR/aspects.html">Aspectos do genesis</a></li><li class="none"><a href="../pt-BR/generic_scripting.html">Suporte a linguagens de script</a></li><li class="none"><a href="../pt-BR/lookup_strategy.html">Estratégias de pesquisa de componentes gráficos</a></li><li class="none"><a href="../pt-BR/widget_binder.html">Customizando o binding de componentes gráficos</a></li></ul></li><li class="none"><a href="../pt-BR/faq.html">FAQ</a></li><li class="none"><a href="http://wiki.java.net/bin/view/Projects/GenesisRoadmap" class="externalLink" title="External Link">Roadmap</a></li><li class="none"><a href="http://wiki.java.net/bin/view/Projects/Genesis" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="http://maven.apache.org/development-process.html" class="externalLink" title="External Link">Development Process</a></li></ul></div><div id="menujava_net"><h5>java.net</h5><ul><li class="none"><a href="https://genesis.dev.java.net" class="externalLink" title="External Link">genesis.dev.java.net</a></li><li class="none"><a href="http://java.net" class="externalLink" title="External Link"><img title="java.net member" style="border: 1px" src="../java_dot_net_member.bmp" alt="java.net member"></img></a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/maven-button-1.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Binding"></a><h2>Binding</h2>
      <p>Uma das funcionalidades mais inovadoras do genesis é o <b>binding</b>.
      O binding mantém a interface gráfica sincronizada automaticamente com um
      JavaBean, a que chamamos de <b>form</b>. Três toolkits gráficos são 
      suportados atualmente para esta integração: Swing, SWT e Thinlet. Abaixo temos
      um exemplo básico de como o binding funciona com essas três APIs para
      implementar uma tela de login. Primeiro, temos o form:</p>

    <div class="source"><pre>
@Form
public class LoginForm {
   private String usuario;
   private String senha;

   public String getUsuario() {
      return usuario;
   }

   public void setUsuario(String usuario) {
      this.usuario = usuario;
   }

   public String getSenha() {
      return senha;
   }

   public void setSenha(String senha) {
      this.senha = senha;
   }

   @Action
   public void login() {
      System.out.println(usuario);
      System.out.println(senha);
   }

   @Action
   public void limpar() {
      setUsuario(null);
      setSenha(null);
   }
}
</pre></div>
  
      <p>A seguir, temos o código para exibir uma tela conectada a este form 
      usando Swing:</p>

    <div class="source"><pre>
@ViewHandler
public class LoginSwingView extends JDialog {
   public LoginSwingView() {
      super(new JFrame(), "Login");
      initComponents();

      SwingBinder binder = new SwingBinder(this, new LoginForm());
      binder.bind();
   }
   
   private void initComponents() {
      getContentPane().setLayout(new GridLayout(2, 1));

      JPanel panelDados = new JPanel();
      panelDados.setLayout(new GridLayout(2, 2, 5, 5));

      JLabel labelUsuario = new JLabel();
      labelUsuario.setText("Usuário");
      panelDados.add(labelUsuario);

      JTextField usuario = new JTextField();
      usuario.setName("usuario");
      panelDados.add(usuario);

      JLabel labelSenha = new JLabel();
      labelSenha.setText("Senha");
      panelDados.add(labelSenha);

      JPasswordField senha = new JPasswordField();
      senha.setName("senha");
      panelDados.add(senha);

      getContentPane().add(panelDados);

      JPanel panelBotoes = new JPanel();

      JButton login = new JButton();
      login.setText("Login");
      login.setName("login");
      panelBotoes.add(login);

      JButton limpar = new JButton();
      limpar.setText("Limpar");
      limpar.setName("limpar");
      panelBotoes.add(limpar);

      getContentPane().add(panelBotoes);

      pack();

      setLocationRelativeTo(null);

      addWindowListener(new WindowAdapter() {
         public void windowClosing(WindowEvent e) {
            System.exit(0);
         }
      });
   }

   public static void main(String args[]) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            new LoginSwingView().setVisible(true);
         }
      });
   }
}
</pre></div>
  
      <p>A mesma tela em SWT:</p>

    <div class="source"><pre>
@ViewHandler
public class LoginSWTView {
   private Shell shell = null;
   private Composite composite = null;
   private Label labelUsuario = null;
   private Text usuario = null;
   private Label labelSenha = null;
   private Text senha = null;
   private Composite compositeBotoes = null;
   private Button limpar = null;
   private Button login = null;

   public LoginSWTView() {
      createShell();
      SWTBinder binder = new SWTBinder(shell, new LoginForm(), this);
      binder.bind();
   }

   private void createShell() {
      shell = new Shell();
      shell.setText("Login");
      createComposite();
      createCompositeBotoes();
      shell.setLayout(new GridLayout());
      
      shell.pack();
   }

   private void createComposite() {
      GridLayout gridLayout = new GridLayout();
      gridLayout.numColumns = 2;

      GridData gridData = new GridData();
      gridData.horizontalAlignment = GridData.FILL;
      gridData.verticalAlignment = GridData.FILL;

      composite = new Composite(shell, SWT.NONE);
      composite.setLayoutData(gridData);
      composite.setLayout(gridLayout);

      labelUsuario = new Label(composite, SWT.NONE);
      labelUsuario.setText("Usuário");

      usuario = new Text(composite, SWT.BORDER);
      usuario.setData("usuario");

      labelSenha = new Label(composite, SWT.NONE);
      labelSenha.setText("Senha");

      senha = new Text(composite, SWT.BORDER | SWT.PASSWORD);
      senha.setData("senha");
   }

   private void createCompositeBotoes() {
      RowLayout rowLayout = new RowLayout();
      rowLayout.fill = true;
      
      GridData gridData = new GridData();
      gridData.horizontalAlignment = GridData.END;
      gridData.verticalAlignment = GridData.FILL;

      compositeBotoes = new Composite(shell, SWT.NONE);
      compositeBotoes.setLayoutData(gridData);
      compositeBotoes.setLayout(rowLayout);
      
      limpar = new Button(compositeBotoes, SWT.NONE);
      limpar.setText("Limpar");
      limpar.setData("limpar");

      login = new Button(compositeBotoes, SWT.NONE);
      login.setText("Login");
      login.setData("login");
   }

   public void display() throws Exception {
      final Display display = Display.getDefault();
      Rectangle bounds = display.getBounds();
      shell.setLocation(bounds.x
            + (bounds.width - shell.getBounds().width) / 2, bounds.y
            + (bounds.height - shell.getBounds().height) / 2);

      shell.open();
      shell.forceActive();
      
      while (!shell.isDisposed()) {
         if (!display.readAndDispatch()) {
            display.sleep();
         }
      }

      display.dispose();
   }

   public static void main(String[] args) throws Exception {
      new LoginSWTView().display();
   }
}
</pre></div>
  
      <p>Por fim, temos o xml e o código necessário para exibir o mesmo form com
      Thinlet:</p>

    <div class="source"><pre>

 1. &lt;panel gap="5" top="5" left="5" bottom="5" right="5" weightx="1"
 2.        weighty="1"&gt;
 3.    &lt;panel gap="5" columns="2" weightx="1"&gt;
 4.       &lt;label text="Usuário" font="bold" /&gt;
 5.       &lt;textfield name="usuario" columns="10" /&gt;
 6.       &lt;label text="Senha" font="bold" /&gt;
 7.       &lt;passwordfield name="senha" columns="10" /&gt;
 8.    &lt;/panel&gt;
 9.    &lt;panel gap="5" halign="center" weightx="1"&gt;
10.       &lt;button name="login" text="Login" /&gt;
11.       &lt;button name="limpar" text="Limpar" /&gt;
12.    &lt;/panel&gt;
13. &lt;/panel&gt;

</pre></div>
  

    <div class="source"><pre>
public class LoginThinletView extends BaseDialogThinlet {
   public LoginThinletView() throws Exception {
      getDialog().setTitle("Login");

      add(parse("login.xml"));
      bind(new LoginForm());
   }

   public static void main(String[] args) throws Exception {
      new LoginThinletView().display();
   }
}
</pre></div>
  
      <p>Através deste exemplo podemos observar algumas coisas importantes sobre
      a definição de um form. Um classe form recebe a anotação 
      <code>@Form</code>, que indica ao genesis que esta classe deve ser tratada 
      de forma especial para que proveja as informações necessárias para o 
      binding.</p>
      <p>As propriedades expostas através de setters e getters - neste caso,
      <code>usuario</code> e <code>senha</code> - podem ser "ligadas" 
      dinamicamente a diversos widgets da interface gráfica, como textfields, 
      passwordfields, labels e outros. Para que isto aconteça, os nomes dos 
      componentes têm que ser iguais aos nomes das propriedades. Com Swing, 
      deve-se usar o método <code>setName(String)</code> dos componentes. Com 
      SWT, o método <code>setData(Object)</code> deve ser usado. Usando Thinlet, 
      conforme mostrado no exemplo acima, isso é feito por definir a propriedade 
      <code>name</code> dos widgets no xml com o nome das propriedades.</p>
      <p>Tanto o valor da propriedade no form quanto sua exibição na tela 
      estarão sincronizados quando o componente que representa a propriedade 
      perder o foco. No caso do exemplo dado, isso acontece quando o usuário 
      pressiona a tecla TAB ou clica com o mouse em algum outro ponto da tela 
      quando o foco está nas caixas de texto <code>usuario</code> ou 
      <code>senha</code>.</p>
      <p>Os métodos também podem ser ligados a botões na interface gráfica. Para
      isso, têm de receber a anotação <code>@Action</code> e devem existir 
      botões com valor da propriedade <code>name</code> igual ao deles na 
      interface gráfica. Assim, quando o botão é acionado o método com nome 
      equivalente é invocado no form. No exemplo dado, ao clicar em Login o 
      valor dos campos Usuário e Senha é impresso na saída padrão, enquanto 
      acionar o botão Limpar exclui o conteúdo dos campos tanto na tela quanto 
      no form.</p>
      <p>A maneira de fazer o binding é dependente da API gráfica. Em todos os
      casos, existe uma classe a que chamamos de <b>view</b>, ou seja, a classe
      que define a interface gráfica e que chama os métodos necessários para 
      efetuar o binding. Para o Swing e SWT, a view sempre deve ser anotada com 
      <code>@ViewHandler</code>. Conforme mostrado acima, o binding no 
      Swing é feito através da classe auxiliar <code>SwingBinder</code> e no 
      SWT, usando-se a classe <code>SWTBinder</code>. Através destas classes é 
      possível fazer diversas customizações no processo de binding, mas o código 
      mostrado no exemplo atende a maioria dos casos. Para o Thinlet, o genesis 
      possui duas classes auxiliares, <code>BaseThinlet</code> e 
      <code>BaseDialogThinlet</code>, que são usadas para construir janelas 
      comuns e janelas de diálogo, respectivamente, e que possuem o método 
      <code>bind(Object)</code>, usado no exemplo.</p>
      <p>As seções subsequentes dão explicações mais detalhadas sobre cada um
      dos bindings.</p>
    </div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2004-2007, Summa Technologies do Brasil Ltda.</div><div class="clear"><hr></hr></div></div></body></html>